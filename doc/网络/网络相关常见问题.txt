网络相关常见问题
>>返回：Linux云服务器常见问题 
目录[隐藏]
1. 访问应用慢怎么办？
2. 常用的网络排障命令？
3. 常用的网络抓包工具？
4. 如何查看IP来源及所属运营商？
5. 如何修改windows本地dns设置？
6. 如何清理dns缓存？
7. 端口不通怎么办？
8. Ping不通怎么办？
9. Telnet不通怎么办？
10. Tracert不通怎么办？
11. 如何测试udp端口是否正常？
12. 如何判断是否受到DDOS网络攻击？
13. 如何防范DDOS网络攻击？
14. 用户网络有问题怎么办？
15. http访问出现40x怎么办？
16. http访问出现50x怎么办？
17. 机器负载很低，但是云服务器操作卡顿，ssh经常断开连接？
1. 访问应用慢怎么办？
首先用户需确认访问慢的原因，包括用户原因，网络原因，服务端原因。
1. 用户原因建议从以下方面排查：
用户电脑性能，电脑病毒，DNS缓存和设置，上网代理，防火墙设置，浏览器版本和插件等，可以通过换电脑测试。

2.网络原因建议从以下方面排查：
确定用户的IP以及网络运营商，域名解析是否正确，是否存在跨网，局域网额外限制，到其他公网服务是否正常，到相关服务器或网络中间路由节点的网络延迟，有无丢包，小运营商网络不稳定等。
建议通过异地正常网络使用相同帐号测试。

3. 服务端问题建议从以下方面排查：
平台问题，如CDN异常，请求转发异常等；服务端问题，如服务器性能，进程状况，程序异常等。

排查时，请配合使用如tcpdump，tracert等各种命令，以及httpwatch，wireshark等抓包工具。
如通过上述技术手段还无法解决，请提供以上排查信息和数据，通过企业QQ联系运维支持协助定位。 

2. 常用的网络排障命令？
命令名称	说明
Ipconfig/ifconfig	显示计算机TCP/IP的详细配置，包括DNS信息，例如ipconfig /all，ipconfig /displaydns。

Ping	包发送命令，可以模拟诊断延迟，丢包，测试网络状况，例如linux：ping 10.1.1.1 -c 10 -s 800，ping 10.1.1.1 -i 0.5，windows：ping qq.com -t，ping 10.1.1.1 -n 8 -l 800。
Tracert/traceroute	跟踪路由，显示数据包到达目的的路径及各节点的时间，可以用来发现运营商节点问题和跨网问题等，如tracert qq.com。
Telnet	远程登录服务命令，主要用于测试端口状态，例如telnet 10.1.1.1 8001。
Nslookup	域名查询工具，主要用来查看域名解析是否正确。
Netstat	wc，netstat -an等。

3. 常用的网络抓包工具？
工具名称	说明
Tcpdump	适用于linux系统。
网络数据采集分析工具，可以对网络数据包进行截获和分析。
通过设定参数来实现对网络数据包的各种监控与分析。
例如，tcpdump -i any -nn tcp and port 443，tcpdump -i any "host 10.1.1.1" -n，tcpdump -s 0 -nX -i eth0 host 113.108.20.23等。
Httpwatch	适用于windows系统。
强大的网页数据分析工具，集成在IE浏览器，也可支持firefox，可以用来诊断前台接口调试，CDN下载资源慢和页面响应慢等问题。
建议使用专业版。
Fiddler	适用于windows系统。
独立的网络抓包工具，可监听所有电脑和互联网的http通讯，可以用来调试和诊断web服务和本地http的交互等问题。
Wireshark	适用于windows和linux系统。
网络封包分析软件，可以实时分析所有支持协议的通讯数据

4. 如何查看IP来源及所属运营商？
请通过以下网站查询：
Ip.qq.com, ip138.com 

5. 如何修改windows本地dns设置？
方法一：
WinXP：
右键网上邻居—>属性(R)—>右键本地链接—>属性(P)，双击Internet协议版本4（TCP/IPV4），修改本地DNS设定。 
Win7：
开始菜单—>控制面板—>网络和共享中心—>本地连接—>属性（P），双击Internet协议版本4（TCP/IPV4），修改本地DNS设定。 

方法二：
开始—>运行—>输入CMD进入到命令模式，输入
命令一：netsh interface ip set dns "网卡名" static 主DNS， 
命令二：netsh interface ip set dns "网卡名" static 辅DNS编号（例如：主DNS设定：netsh interface ip set dns "本地连接" static 8.8.8.8，辅DNS设定：netsh interface ip set dns "本地连接" static 8.8.8.8 2）。 

6. 如何清理dns缓存？
方法一：
开始菜单—>管理工具—>服务，重启DNS Client和DHCP client两项服务。

方法二：
开始菜单—>运行—>输入CMD进入命令模式，输入ipconfig/flushdns,回车执行，提示成功即可。 

7. 端口不通怎么办？
服务端：
确认是否有监听对应的端口，是否有做访问限制。 

客户端：
测试连接方式是否正常，例如TELNET只能测试TCP端口，UDP端口可以使用NETCAT等工具进行测试.可以通过wireshark和tcpdump等工具查看具体的数据包走向，明确定位问题。 

其他：
腾讯机房禁止不同应用的机器相互访问，如果同一应用内端口无法正常访问，请通过企业QQ联系运维支持查询防火墙设置。 

8. Ping不通怎么办？
请确认网络是否可用，域名解析是否正确，服务端是否禁止ICMP包，使用tracert/traceroute协助确定网络故障。
如通过上述技术手段还无法解决，请提供以上排查信息和数据，请通过企业QQ联系运维支持协助定位。 

9. Telnet不通怎么办？
Telnet不通，指的是telnet之后没有任何返回，如果直接返回信息，则表示telnet是通的，但是请求被直接拒绝。

故障排查步骤：
在telnet源上，通过ping测试网络是否正常；
在目标机器上，确认服务器是否设置了禁止telnet（默认没有设置），是否监听了正确的IP和端口，可以通过telnet 127.0.0.1测试本地telnet服务；
对于hosting应用，如果通过以上技术手段还无法解决问题，请提供相应信息和数据，请通过企业QQ联系运维支持排查腾讯防火墙设置。 

10. Tracert不通怎么办？
tracert不通，指的是从某一节点开始，全部是*，并且无法到达目的，如果只是中间某一个节点出现*，则只能说明该节点禁止被tracert。

故障排查步骤：
从tracert的第一个节点开始，到最后一个可访问节点，查询各节点IP的所属运营商，可以判断网络访问路径以及运营商，然后定位是运营商问题，还是目标服务的问题。
注意，小运营商跨网问题，需要自助向运营商反馈。 

11. 如何测试udp端口是否正常？
Udp包的发送和监听可以使用如下方法：
发送udp包，使用netcat命令，例如netcat -v -u 10.1.1.1 8001，同时使用tcpdump或者netcat监听udp请求。 

12. 如何判断是否受到DDOS网络攻击？
可以结合以下现象初步判断是否受到DDOS攻击：
机器入流量出现陡增，同时出流量急剧下降； 
服务器出现大量SYN，TIME_WAIT等异常连接( netstat –a |awk '{print $6}' |sort|uniq -c|sort -gk 1)；
某些IP访问频率过高，占用大量资源(netstat -tun|awk '{print $5}'|uniq -c|sort -r)，导致服务不正常等。
注：腾讯已经对常见的攻击进行了监控和防范，用户也可结合自身逻辑在服务器端限制特定IP访问。 

13. 如何防范DDOS网络攻击？
为了防范DDOS网络攻击，建议用户进行如下开发：
1. 建议在Server端引入超时机制，对指定时间内未发送请求或是未发完请求的客户端主动断开，规避空连接或是慢速请求攻击；
2. 建议对客户端请求频率做统计，对频繁超过配置的源IP，临时封禁一段时间，或是使用验证码进行限制，防止刷请求；
3. 建议安全保护逻辑前置在所有业务逻辑之前，避免恶意请求消耗过多服务器性能。 

14. 用户网络有问题怎么办？
单个用户网络问题，建议用户协助用户检查其电脑设置，包括DNS，上网代理，防火墙，局域网设置，是否跨网等；
如果是批量用户出现网络问题，可以收集共性信息，比如地域，运营商，访问方式等，然后通过企业QQ联系运维支持进行问题定位和解决。 

15. http访问出现40x怎么办？
当http返回码出现40x的时候，表示用户提交的请求被服务器接受，但是被认为是错误的请求，包括：
请求语法错误，请求文件不存在，服务器拒绝请求，客户端请求发送超时等。 
用户需要结合客户端请求和服务端设置来详细定位。详细返回信息信息请参考：
http://zh.wikipedia.org/wiki/HTTP%E7%8A%B6%E6%80%81%E7%A0%81 

16. http访问出现50x怎么办？
当http返回码出现50x的时候，表示服务器在处理正确请求时，出现了内部错误，属于服务端问题。
建议用户在服务代码和逻辑中进行定位。详细返回码信息请参考：
http://zh.wikipedia.org/wiki/HTTP%E7%8A%B6%E6%80%81%E7%A0%81

17. 机器负载很低，但是云服务器操作卡顿，ssh经常断开连接？
原因分析：
如果您是在预付费模式下购买的包月或包年云服务器，那么可能是由于购买时为服务器制定的带宽太小导致的。带宽太小，一旦满了就会丢包，操作人员的感受就是卡顿。
解决方案：
（1）在监控告警中配置告警接收人，一旦流量超出带宽限制，会发送告警短信到告警接收人的手机上，收到告警后，去调高该台服务器的带宽配置即可。
（2）如果您的帐号在腾讯云的上个月消耗>5W，则可以在管理中心的工单系统中提单申请开通带宽流量包白名单。开通后，带宽没有上限，次月按照实际使用流量结算，每M带宽108元/月。